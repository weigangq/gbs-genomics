library(ggplot2)
library(tidyverse)
library(dplyr)
library(reshape2)
setwd('/Users/brandonely/Desktop/gbs-genomics/data')
#read data
pi.windows <- read.table('snps2_10k.windowed.pi', header = T)
#read data
taj <- read.table('snps2_10k.Tajima.D', header = T)
#merge pi and tajima data
pi2 <- pi.windows %>% select(2,5)
taj2 <- taj %>% select(2,4)
taj2$BIN_START <- taj2$BIN_START + 1
View(pi2)
View(taj2)
cut1.win <- read.table('cut_1.windowed.weir.fst', header = T) %>%
mutate('population' = 'cut_1')
View(cut1.win)
cut1.fst2 <- cut1.win %>% select(2,5)
View(cut1.fst2)
df <- merge(x = pi2, y = taj2, by = 'BIN_START', all = T)
View(df)
df <- merge(x = df, y = cut1.fst2, by = 'BIN_START', all = T)
View(df)
df2 <- melt(df, id.var="BIN_START")
View(df2)
unique(df2, variable)
unique(df2$variable)
#plot
ggplot(df2, aes(x = BIN_START, y = value)) + geom_line(aes(color = variable)) +
labs(title = 'GBS snp analysis', subtitle = '10k sliding windows' ,x = 'genome position') +
facet_grid(variable ~ ., scales = "free_y") + theme(legend.position = "none")
#read data
pi.windows <- read.table('snps2_10k.windowed.pi', header = T)
#read data
taj <- read.table('snps2_10k.Tajima.D', header = T)
cut1.win <- read.table('cut_1.windowed.weir.fst', header = T) %>%
mutate('population' = 'cut_1')
#merge data
pi2 <- pi.windows %>% select(2,5)
taj2 <- taj %>% select(2,4)
taj2$BIN_START <- taj2$BIN_START + 1
cut1.fst2 <- cut1.win %>% select(2,5)
df <- merge(x = pi2, y = taj2, by = 'BIN_START', all = T)
df <- merge(x = df, y = cut1.fst2, by = 'BIN_START', all = T)
df2 <- melt(df, id.var="BIN_START")
View(df2)
#plot
ggplot(df2, aes(x = BIN_START, y = value)) + geom_line(aes(color = variable)) +
labs(title = 'GBS snp analysis', subtitle = '10k sliding windows' ,x = 'genome position') +
facet_grid(variable ~ ., scales = "free_y") + theme(legend.position = "none")
df <- Reduce(function(x, y) merge(x, y, all=TRUE), df_list)
df_list <- list(pi2, taj2, cut1.fst2)
View(df_list)
df <- Reduce(function(x, y) merge(x, y, all=TRUE), df_list)
View(df)
View(df)
df2 <- melt(df, id.var="BIN_START")
View(df2)
df <- df_list %>% reduce(full_join, by='BIN_START')
View(df)
#df <- Reduce(function(x, y) merge(x, y, all=TRUE), df_list)
df2 <- melt(df, id.var="BIN_START")
View(df2)
#plot
ggplot(df2, aes(x = BIN_START, y = value)) + geom_line(aes(color = variable)) +
labs(title = 'GBS snp analysis', subtitle = '10k sliding windows' ,x = 'genome position') +
facet_grid(variable ~ ., scales = "free_y") + theme(legend.position = "none")
View(df2)
cut0_pi.windows <- read.table('cut_0.windowed.pi', header = T)
View(cut0_pi.windows)
cut0_pi.windows <- read.table('cut_0.windowed.pi', header = T)
View(cut0_pi.windows)
#cut0_pi.windows <- read.table('cut_0.windowed.pi', header = T)
cut0_pi.win <- read.table('cut_0.windowed.pi', header = T) %>%
mutate('population' = 'cut_0')
View(cut0_pi.win)
#cut0_pi.windows <- read.table('cut_0.windowed.pi', header = T)
cut0_pi.win <- read.table('cut_0.windowed.pi', header = T) %>%
mutate('population' = 'cut_0')
cut1_pi.win <- read.table('cut_1.windowed.pi', header = T) %>%
mutate('population' = 'cut_1')
cut2_pi.win <- read.table('cut_2.windowed.pi', header = T) %>%
mutate('population' = 'cut_2')
cut3_pi.win <- read.table('cut_3.windowed.pi', header = T) %>%
mutate('population' = 'cut_3')
View(cut1_pi.win)
View(cut2_pi.win)
View(cut3_pi.win)
#combine data
pop_pi.win <- do.call("rbind", list(cut0_pi.win, cut1_pi.win, cut2_pi.win, cut3_pi.win))
View(pop_pi.win)
View(pop_pi.win)
pop_pi.win <- pop_pi.win %>% select(2,5,6)
View(pop_pi.win)
View(pop_pi.win)
#plot
pop_pi.win %>%
ggplot(aes(x = BIN_START, y = PI, color = population)) +
geom_line() +
facet_grid(rows = vars(population))
#plot
pop_pi.win %>%
ggplot(aes(x = BIN_START, y = PI, color = population)) +
geom_line() #+
#plot
pop_pi.win %>%
ggplot(aes(x = BIN_START, y = PI, color = population)) +
geom_line() +
facet_grid(rows = vars(population))
