# load libraries
library(tidyverse) # load a package into memory
library(readxl) # load another package
x <- read_tsv("http://diverge.hunter.cuny.edu/~weigang/bio203.txt"
x <- read_tsv("http://diverge.hunter.cuny.edu/~weigang/bio203.txt")
x <- read_tsv("http://diverge.hunter.cuny.edu/~weigang/bio203.txt")
x
bio203.long <- x %>% pivot_longer(2:4, names_to = "Genotype", values_to = "Count")
bio203.long
data("iris")
glimpse(iris)
iris %>% ggplot(aes(x = Species, y = Sepal.Length )) +
geom_boxplot() +
theme_bw() +
coord_flip()
theme_bw() +
coord_flip()
iris %>% ggplot(aes(x = Species, y = Sepal.Length )) +
geom_boxplot() +
geom_point(shape = 1) +
theme_bw() +
coord_flip()
iris %>% ggplot(aes(x = Species, y = Sepal.Length )) +
geom_boxplot() +
geom_jitter(shape = 1) +
theme_bw() +
coord_flip()
iris %>% ggplot(aes(x = Species, y = Sepal.Length )) +
geom_boxplot() +
geom_jitter(shape = 1, width = 0.2) +
theme_bw() +
coord_flip()
# scatter plot to compare sepal length versus sepal width, which suggest significant correlation that can be tested with linear regression
iris %>% ggplot(aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +
geom_point(shape = 1) +
geom_smooth(method = "lm") +
facet_wrap(~Species) +
theme_bw()
q()
library(drc)
citation(drc)
citation("drc")
version("drc")
session.info()
sessions.info()
sessionInfo()
q()
install.packages("gplots")
install.packages("umap")
install.packages(c("broom", "conflicted", "dbplyr", "dplyr", "dtplyr", "forcats", "ggplot2", "googlesheets4", "haven", "hms", "httr", "jsonlite", "lubridate", "magrittr", "modelr", "pillar", "purrr", "ragg", "readr", "readxl", "reprex", "vest", "stringr", "tibble", "tidyr"))
install.packages(c("broom", "conflicted", "dbplyr", "dplyr", "dtplyr", "forcats", "ggplot2", "googlesheets4", "haven", "hms", "httr", "jsonlite", "lubridate", "magrittr", "modelr", "pillar", "purrr", "ragg", "readr", "readxl", "reprex", "vest", "stringr", "tibble", "tidyr"))
install.packages(c("broom", "conflicted", "dbplyr", "dplyr", "dtplyr", "forcats", "ggplot2", "googlesheets4", "haven", "hms", "httr", "jsonlite", "lubridate", "magrittr", "modelr", "pillar", "purrr", "ragg", "readr", "readxl", "reprex", "vest", "stringr", "tibble", "tidyr"))
sessionInfo()
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
tidyverse_update()
library(tidyverse)
tidyverse_update()
install.packages(c("dbplyr", "dplyr", "dtplyr", "ggplot2", "googledrive", "googlesheets4",
"hms", "modelr", "pillar", "rlang", "tibble"))
install.packages(c("dbplyr", "dplyr", "dtplyr", "ggplot2", "googledrive", "googlesheets4", "hms", "modelr", "pillar", "rlang", "tibble"))
library(tidyverse)
library(ggtree)
library(ggtree)
install.packages("ggtree")
sessionInfo()
q()
(0.45+0.5)/(0.45*0.5+0.55*0.4)
(0.45*0.5)/(0.45*0.5+0.55*0.4)
q()
setwd("C:/Users/weiga/Dropbox/QiuDi/GBS-Wu/")
setwd("Dropbox/gbs-genomics/")
setwd("C:/Users/weiga/Dropbox/gbs-genomics/")
#setwd("Dropbox/gbs-genomics/")
#library(ape)
#library(genoPlotR)
library(tidyverse)
#####################
# 5/12/2023, n=256 isolates
#####################
#BiocManager::install("ggtree")
library(ggtree)
library(readxl)
#tree <- treeio::read.tree("contree-257.dnd4")
tree <- treeio::read.tree("data/contree-v2.dnd")
tree <- treeio::read.tree("data/per_branch.labelled_tree.newick")
dd <- read_xlsx("data/gbs-pheno.xlsx", col_types = "text")
tips <- tibble(id=tree$tip.label)
tips <- tips %>% left_join(dd, c("id" = "node")) # direct reading didn't work
col <- c("green", "red", "blue")
p1 <- ggtree(tree, layout = "fan")  %<+% tips +
geom_treescale() +
geom_tippoint(aes(color = virulence)) +
#  geom_tiplab(align = TRUE, size = 2) +
geom_tiplab(align = TRUE, size = 2.7, aes(color = factor(wgs))) +
scale_color_manual(values = col)  +
theme(legend.position = c(0.6,0.4),
legend.title = element_blank(), # no title
legend.key = element_blank()) # no keys
p1
dd <- read_xlsx("data/gbs-pheno.xlsx", col_types = "text")
tips <- tibble(id=tree$tip.label)
tips <- tips %>% left_join(dd, c("id" = "node")) # direct reading didn't work
col <- c("green", "red", "blue")
p1 <- ggtree(tree, layout = "fan")  %<+% tips +
geom_treescale() +
geom_tippoint(aes(color = virulence)) +
#  geom_tiplab(align = TRUE, size = 2) +
geom_tiplab(align = TRUE, size = 2.7, aes(color = factor(wgs))) +
scale_color_manual(values = col)  +
theme(legend.position = c(0.6,0.4),
legend.title = element_blank(), # no title
legend.key = element_blank()) # no keys
p1
