# gbs snp analysis
library(tidyverse)
setwd("~/Dropbox/gbs-genomics/")
install.packages("smartsnp")
library(smartsnp)
library(readxl)
groups <- read_xlsx("data/gbs-pheno.xlsx")
sm.pca <- smart_pca(snp_data = "data/region_genotype.traw",
sample_group = samples,
missing_value = NA)
samples <- groups %>%
filter(node != 'B111') %>%
pull(2)
sm.pca <- smart_pca(snp_data = "data/region_genotype.traw",
sample_group = samples,
missing_value = NA)
install.packages("adegenet")
library(adegenet)
file.show(system.file("files/exampleSnpDat.snp",package="adegenet"))
# ref/tutorial: https://adegenet.r-forge.r-project.org/files/tutorial-genomics.pdf
# build genlight object
x <- read_tsv("data/region_genotype.traw")
glimpse(x)
x
x.mat <- x %>% select(6:261) %>% t()
x.mat
head(x.mat)
x.mat[1:10, 1:10]
View(x)
x.mat <- x %>% select(7:261) %>% t()
x.mat[1:10, 1:10]
dim(x.mat)
# ref/tutorial: https://adegenet.r-forge.r-project.org/files/tutorial-genomics.pdf
# build genlight object
x <- read_tsv("data/snp_mat.tsv")
View(x)
# ref/tutorial: https://adegenet.r-forge.r-project.org/files/tutorial-genomics.pdf
# build genlight object
x <- read_tsv("data/snp_mat.tsv")
View(x)
# ref/tutorial: https://adegenet.r-forge.r-project.org/files/tutorial-genomics.pdf
# build genlight object
x <- read_tsv("data/snp_mat.tsv", col_names = F)
View(x)
x.gen <- new("genlight", x)
x.gen <- new("genlight", t(x))
x.gen
ids <- scan("data/snp_sample_ids.txt")
ids <- scan("data/snp_sample_ids.txt", what = "c")
x.gen@ind.names <- ids
x.gen
x.gen@ind.names
x.gen
ploidy(x.gen)
